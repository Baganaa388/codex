# CodeX Olympiad — Админ ашиглах заавар

## Агуулга

1. [Нэвтрэх](#1-нэвтрэх)
2. [Тэмцээн үүсгэх](#2-тэмцээн-үүсгэх)
3. [Бодлого нэмэх](#3-бодлого-нэмэх)
4. [Оролцогчдын бүртгэл](#4-оролцогчдын-бүртгэл)
5. [Дүн оруулах (IOI Scoring)](#5-дүн-оруулах-ioi-scoring)
6. [Тохиргоо](#6-тохиргоо)
7. [Leaderboard](#7-leaderboard)
8. [Environment тохиргоо](#8-environment-тохиргоо)

---

## 1. Нэвтрэх

**URL:** `/admin`

Анхдагч нэвтрэх мэдээлэл (`.env`-ээс өөрчилж болно):

| Талбар | Утга |
|--------|------|
| Имэйл | `admin@codex.mn` |
| Нууц үг | `changeme123` |

> Анхааруулга: Production орчинд `ADMIN_EMAIL` болон `ADMIN_PASSWORD` environment variable-ыг заавал өөрчилнө үү.

Нэвтэрсний дараа JWT token localStorage-д хадгалагдана. Token 24 цагийн дараа дуусна.

---

## 2. Тэмцээн үүсгэх

Dashboard-аас **"Шинэ тэмцээн"** товч дарна.

### Талбарууд:

| Талбар | Тайлбар | Жишээ |
|--------|---------|-------|
| **Нэр** | Тэмцээний нэр | `CodeX[4] - 2026` |
| **Тайлбар** | Товч тайлбар (заавал биш) | `4 дэх удаагийн олимпиад` |
| **Эхлэх цаг** | Тэмцээн эхлэх огноо, цаг | `2026-04-15 10:00` |
| **Дуусах цаг** | Тэмцээн дуусах огноо, цаг | `2026-04-15 13:00` |

Тэмцээн үүссэний дараа **"Бүртгэл нээлттэй" (registration)** статустай байна. Энэ статустай үед бүртгэлийн хуудаснаас оролцогчид бүртгүүлж чадна.

### Тэмцээний статусууд:

| Статус | Тайлбар |
|--------|---------|
| `Ноорог` (draft) | Бэлтгэж буй, нийтэд харагдахгүй |
| `Бүртгэл нээлттэй` (registration) | Оролцогчид бүртгүүлж болно |
| `Явагдаж байна` (active) | Тэмцээн эхэлсэн |
| `Дүн шалгаж байна` (grading) | Дүн оруулж байна |
| `Дууссан` (finished) | Бүх зүйл дууссан |

---

## 3. Бодлого нэмэх

Тэмцээн дээр дарж ороод **"Бодлого"** таб-руу орно.

### Бодлого нэмэх:

1. **"Бодлого нэмэх"** товч дарна
2. Бодлогын нэр оруулна (жнь: `A. Fibonacci`)
3. **Subtask** (дэд даалгавар) нэмнэ:

| Талбар | Тайлбар | Жишээ |
|--------|---------|-------|
| **Label** | Subtask-ын нэр | `Sub1`, `Sub2` |
| **Оноо** | Энэ subtask-д ногдох оноо | `20`, `30`, `50` |
| **Test** | Test case тоо | `5`, `10` |

### IOI Scoring тайлбар:

- Бодлого бүр хэд хэдэн **subtask**-тай (жнь: 20+30+50 = 100 оноо)
- Subtask тэнцвэл бүтэн оноо авна, тэнцэхгүй бол 0
- Нэг оролцогч нэг бодлогыг **олон удаа** submit хийж болно
- Систем subtask тус бүрийн **хамгийн өндөр** оноог авч тооцно
- Нийт оноо = бүх бодлогын хамгийн сайн оноонуудын нийлбэр

**Жишээ:**

```
Бодлого A: Sub1(20), Sub2(30), Sub3(50)

1-р submission: Sub1 ✓, Sub2 ✗, Sub3 ✗  → 20 оноо
2-р submission: Sub1 ✗, Sub2 ✓, Sub3 ✗  → 30 оноо

Хамгийн сайн: Sub1=20, Sub2=30, Sub3=0 → Нийт: 50 оноо
```

---

## 4. Оролцогчдын бүртгэл

### Оролцогч хэрхэн бүртгүүлэх вэ?

1. `/registration` хуудсанд орно
2. Олимпиад сонгоно (бүртгэл нээлттэй олимпиадууд харагдана)
3. Мэдээллээ бөглөнө (овог, нэр, имэйл, утас, сургууль, ангилал)
4. Бүртгэл амжилттай бол **бүртгэлийн дугаар** гарна (жнь: `CX4-0001`)

### Ангилал:

| Ангилал | Тайлбар |
|---------|---------|
| **Бага** | Бага ангийн сурагчид |
| **Дунд** | Дунд ангийн сурагчид |
| **Ахлах** | Ахлах ангийн сурагчид |

### Админ талаас:

Тэмцээн дотор **"Оролцогчид"** таб-аас:
- Бүртгүүлсэн бүх оролцогчдыг харна
- Нэр, дугаар, сургуулиар хайж болно
- Дугаар, нэр, сургууль, ангилал, утас харагдана

---

## 5. Дүн оруулах (IOI Scoring)

Тэмцээн дотор **"Дүн оруулах"** таб-руу орно.

### Алхам:

1. **Бүртгэлийн дугаар** оруулна (жнь: `CX4-0001`)
2. **Бодлого** сонгоно
3. Subtask тус бүрд **"Тэнцсэн"** эсвэл **"Тэнцээгүй"** товч дарна
4. **"Дүн илгээх"** дарна

Дүн илгээгдсэн үед:
- Submission бүртгэгдэнэ
- Subtask тус бүрийн оноо тооцоологдоно
- Leaderboard автоматаар шинэчлэгдэнэ (rank, нийт оноо, penalty)
- Амжилттай бол нийт оноо харуулна

### Нэг оролцогчийн нэг бодлогыг олон удаа оруулах:

Систем автоматаар subtask тус бүрийн хамгийн өндөр оноог авч тооцно. Тиймээс нэг бодлогыг олон удаа submit хийж болно.

---

## 6. Тохиргоо

Тэмцээн дотор **"Тохиргоо"** таб-руу орно.

### Статус өөрчлөх:

Тэмцээний статусыг товч дарж шууд өөрчилнө:
- `Ноорог` → `Бүртгэл нээлттэй` → `Явагдаж байна` → `Дүн шалгаж байна` → `Дууссан`

> Зөвхөн `Бүртгэл нээлттэй` статустай үед оролцогчид бүртгүүлж болно.

### Leaderboard дахин тооцоолох:

**"Дахин тооцоолох"** товч дарвал бүх оролцогчдын оноо, penalty, rank-ыг дахин тооцоолно. Ихэвчлэн хэрэг болохгүй (submission оруулах бүрт автоматаар шинэчлэгддэг), гэхдээ алдаа засварлах, эсвэл гараар DB өөрчилсөн тохиолдолд ашиглана.

---

## 7. Leaderboard

Нийтэд харагдах leaderboard: `/leaderboard`

- **Олимпиадаар** шүүж харна
- **Ангилалаар** шүүж харна (Бага / Дунд / Ахлах)
- **Нэрээр** хайж болно
- Харуулах мэдээлэл: Байр, Оролцогчийн нэр, Сургууль, Оноо, Хугацаа (penalty минут)
- Топ 3 оролцогч тусгай тэмдэглэгээтэй (алт, мөнгө, хүрэл)

### Эрэмбэ тогтоох дүрэм:

1. **Нийт оноо** буурах дарааллаар (өндөр оноотой нь дээр)
2. Оноо тэнцвэл **penalty** өсөх дарааллаар (бага penalty-тэй нь дээр)

Penalty = оноо сайжруулсан submission бүрийн хугацааны нийлбэр (минутаар)

---

## 8. Environment тохиргоо

### `.env` файл (server/):

```env
# Database
DATABASE_URL=postgresql://user:pass@host:5432/dbname

# JWT
JWT_SECRET=your-secret-key-here
JWT_EXPIRES_IN=24h

# Admin (seed хийхэд ашиглагдана)
ADMIN_EMAIL=admin@codex.mn
ADMIN_PASSWORD=your-secure-password

# Server
PORT=4000
NODE_ENV=production
```

### Анх deploy хийсний дараа:

```bash
# Migration ажиллуулах (DB хүснэгтүүд үүсгэх)
npm run migrate

# Анхдагч админ хэрэглэгч үүсгэх
npm run seed
```

### Локал хөгжүүлэлт:

```bash
# Server эхлүүлэх (port 4000)
cd server && npm run dev

# Frontend эхлүүлэх (port 5173, API proxy → 4000)
npm run dev
```

---

## Ажлын урсгал (товчхон)

```
1. /admin руу нэвтрэх
        ↓
2. Тэмцээн үүсгэх → статус: "Бүртгэл нээлттэй"
        ↓
3. Бодлого + Subtask нэмэх
        ↓
4. Оролцогчид /registration-аас бүртгүүлнэ
        ↓
5. Статус → "Явагдаж байна"
        ↓
6. Тэмцээн дууссаны дараа: Статус → "Дүн шалгаж байна"
        ↓
7. "Дүн оруулах" таб-аас оролцогч бүрийн дүнг оруулна
        ↓
8. Leaderboard автоматаар шинэчлэгдэнэ
        ↓
9. Статус → "Дууссан"
```
